"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,r,s){return r&&e(t.prototype,r),s&&e(t,s),t}}(),FrondevoAJAXSubmitForm=function(){function e(t){_classCallCheck(this,e),this.formSelector=t.formSelector,this.invalidRowClassName=t.invalidRowClassName,this.formRowSelector=t.selectorFormRow,this.errorMessageSelector=t.selectorErrorMessage,this.form=$(this.formSelector),this.formType=this.form.attr("method")||"get",this.scriptUrl=this.form.attr("action"),this.sendingData="",this.serverAnswer="",this.needValidate=t.needValidate||!0,this._eventHandlersInit()}return _createClass(e,[{key:"_sendData",value:function(){var e=$.Deferred();return $.ajax({type:this.formType,dataType:"json",url:this.scriptUrl,data:this.sendingData}).done(function(t){e.resolve(t)}).fail(function(t){e.reject(t.statusText)}),e.promise()}},{key:"_validateForm",value:function(e){var t=this;e.preventDefault(),this.sendingData=this.form.serialize(),this._sendData().then(function(e){"ERROR"==e.status.toUpperCase()?t._showError(e.invalidInputName,e.message):e.goToUrl?t._goToUrlAfterSuccessSend(e.goToUrl):(t.serverAnswer=e.message,t._firedSendSuccess())},function(e){console.error("Не удалось отправить данные формы!",e)})}},{key:"_showError",value:function(e,t){var r=this.form.find('[name="'+e+'"]'),s=r.parents(this.formRowSelector).eq(0),n=s.find(this.errorMessageSelector).eq(0);n.text(t),s.addClass(this.invalidRowClassName)}},{key:"_goToUrlAfterSuccessSend",value:function(e){window.location=e}},{key:"_firedSendSuccess",value:function(){var e=$.Event("ajax-submit:success");this.form.trigger(e)}},{key:"getServerAsnswer",value:function(){return this.serverAnswer}},{key:"_eventHandlersInit",value:function(){var e=this;$(this.formSelector).on("submit",function(t){return e._validateForm(t)})}}]),e}();